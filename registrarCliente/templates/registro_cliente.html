{% extends 'inicio/base.html' %}
{% load static %}

{% block content %}
  <div class="container mt-5 my-5 border" id="formulario-container">
    <h2 class="mb-4 text-center">REGISTRAR CLIENTE</h2>
    <form method="POST" action="{% url 'registrar_cliente' %}" id="registroForm">
    {% csrf_token %}
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="form-group">
            <label for="nombre">Nombre: <span class="campo-obligatorio">*</span></label><br>
            <input type="text" id="nombre" class="nombre form-control" required oninput="validarNombre(this)" data-error="nombreError">
            <small id="nombreError" class="text-danger"></small>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            
            <label for="apellido">Apellido: <span class="campo-obligatorio">*</span></label><br>
            <input type="text" id="apellido" name="apellido" class="nombre form-control" required oninput="validarApellido(this)" data-error="apellidoError">
            <small id="apellidoError" class="text-danger"></small>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="form-group">
            <label for="telefono">Teléfono: <span class="campo-obligatorio">*</span></label><br>
            <input type="text" id="telefono" name="telefono" class="telefono form-control" required oninput="validarTelefono(this)" data-error="telefonoError" >
            <small id="telefonoError" class="text-danger"> </small>
            {% if telefonoRepetido %}
            <small class="text-danger">{{ telefonoRepetido }}</small>
            {% endif %}
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label for="fecha-nacimiento">Fecha de Nacimiento: <span class="campo-obligatorio">*</span></label><br>
            <input type="date" id="fecha-nacimiento" name="fecha_nacimiento" class="fecNac form-control" required data-error="fechaError" required oninput="validarFechaNacimiento(this)">
            <small id="fechaError" class="text-danger"></small>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="pais">País: <span class="campo-obligatorio">*</span></label><br>
          <input type="text" id="pais" name="pais" class="ubicacion form-control" required oninput="validarUbicacion(this)" required data-error="paisError">
          <small id="paisError" class="text-danger"></small>
        </div>
        <div class="col-md-4">
          <label for="ciudad">Ciudad: <span class="campo-obligatorio">*</span></label><br>
          <input type="text" id="ciudad" name="ciudad" class="ubicacion form-control" required oninput="validarUbicacion(this)" required data-error="ciudadError">
          <small id="ciudadError" class="text-danger"></small>
        </div>
        <div class="col-md-4">
          <label for="localidad">Localidad: <span class="campo-obligatorio">*</span></label><br>
          <input type="text" id="localidad" name="localidad" class="ubicacion form-control" required oninput="validarUbicacion(this)" required data-error="localidadError">
          <!-- Agrega una pequeña etiqueta para mostrar mensajes de error -->
          <small id="localidadError" class="text-danger"></small>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="form-group">
            <label for="email">Email: <span class="campo-obligatorio">*</span></label><br>
            <input type="email" id="email" name="correo" class="email form-control" required oninput="validarCorreo(this)" required data-error="emailError">
            <small id="emailError" class="text-danger"></small>
            {% if correoRepetido %}
            <small class="text-danger">{{ correoRepetido }}</small>
            {% endif %}
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label for="contrasena">Contraseña: <span class="campo-obligatorio">*</span></label><br>
            <div class="input-group">
              <input type="text" id="contrasena1" class="paswd form-control" required required data-error="contError">
              <div class="btn-container" onclick="togglePasswordVisibility('contrasena1', 'togglePasswordIconR')">
                <button type="button" class="btn btn-outline-secondary">
                  <i class="fas fa-eye" id="togglePasswordIconR"></i>
                </button>
              </div>
            </div>
          </div>
          <small id="contError" class="text-danger"></small>
        </div>
        </div>
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="form-group">
            {{ form.genero }}
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label for="repetir-contrasena">Repetir contraseña: <span class="campo-obligatorio">*</span></label><br>
            <div class="input-group">
              <input type="text" id="contrasena2" class="paswd form-control" required data-error="cont2Error" oninput="validarContrasenas(this)">
              <div class="btn-container" onclick="togglePasswordVisibility('contrasena2', 'togglePasswordIcon')">
                <button type="button" class="btn btn-outline-secondary">
                  <i class="fas fa-eye" id="togglePasswordIcon"></i>
                </button>
              </div>
            </div>
            <small id="cont2Error" class="text-danger"></small>
          </div>
        </div>
        </div>
      <div class="form-group mb-3">
        <label for="descripcion">Descríbete: <span class="campo-obligatorio">*</span></label><br>
        <textarea id="descripcion" name="descripcion" class="desc form-control" required oninput="validarDescripcion(this)" data-error="descripcionError"></textarea>
        <small id="descripcionError" class="text-danger"></small>
      </div>
      <div class="checkbox-group mb-3">
        <div>
          <input type="checkbox" id="aviso-legal" required>
          <small id="avisoError" class="text-danger"></small>
          <label for="aviso-legal">He leído y acepto el aviso legal y la Política de privacidad. <span style="color: red">*</span></label>
        </div>
        <div>
          <input type="checkbox" id="terminos-condiciones" required>
          <small id="termError" class="text-danger"></small>
          <label for="terminos-condiciones">Acepto los términos y condiciones. <span style="color: red">*</span></label>
        </div>
      </div>
      <div class="button-group" style="display: flex; justify-content: space-between;">
        <button class="btn btn-secondary" type="button">CANCELAR</button>
        <button class="btn btn-primary" type="submit" onclick="return validarFormulario();">CONTINUAR</button>
      </div>

    </form>
  </div>
</form>
  <!--</form>-->

  {% endblock %}



  {% block extrajs %}

<script type="text/javascript">
  document.getElementById('registroForm').addEventListener('submit', function(event) {
  
    if(confirm("¿Guardar horario seleccionado?")){
        alert("Horario guardado con éxito.");
    }else {
        event.preventDefault();  
    }
  });
  function volverAtras() {
      window.history.back();
  }
  function mostrarAviso() {
      alert("Reserva exitosa");
  }




function validarDescripcion(elemento) {
  const descripcionInput = elemento.value.trim();
  if (descripcionInput.length < 50) {
    elemento.nextElementSibling.textContent = 'La descripción debe tener al menos 50 caracteres';
    elemento.classList.add('is-invalid');
  } else {
    elemento.nextElementSibling.textContent = '';
    elemento.classList.remove('is-invalid');
  }
}

</script>
{% endblock extrajs %}